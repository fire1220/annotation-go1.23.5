# 内存分配

### 相关代码位置
- src/runtime/mcache.go
- src/runtime/mheap.go
- runtime/malloc.go

### 内存存储单元
- page 叶，每页大小是8KB
- mspan 跨度类，内存分配的最小单元,可以存放1个或多个page,通过page基地址和叶个数实现
- mheap 堆内存
- mcentral 中心缓存，多个线程共享，使用是需要加锁，初始化是不产生数据，只有使用时才向mheap中申请
- mcache 线程缓存，每个线程共享，使用时不需要加锁，初始化是不产生数据，只有使用时才向mcentral中申请

### 内存分配

分配函数：newobject -> mallocgc

**mallocgc功能：**

1. 会分配微对象、小对象、大对象
2. 清扫未使用的内存

